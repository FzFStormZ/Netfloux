{% extends 'base.html.twig' %}

{% block title %}Series{% endblock %}

{% block body %}

    <section class="navbar-area p-3 mb-2 bg-primary text-white">
        {% include 'home/navbar.html.twig' %}
    </section>

    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    
    <h1>{{ series.title }}</h1>

    <table class="table">
        <tbody>
            <tr>
                {% if app.user %}
                    {% if rating == null %}
                        <td>
                            {{ form_start(ratingForm) }}
                                {{ form_row(ratingForm.rating) }}
                                {{ form_row(ratingForm.comment) }}
                                <button type="submit" class="btn">Submit</button>
                            {{ form_end(ratingForm) }}
                        </td>
                    {% else %}
                        <td>
                            <h3>Note : {{ rating.value }}/10</h3>
                            <p>Your comment : {{ rating.comment }}</p>
                        </td>
                    {% endif %}
                    {% if follow == false %}
                        <td>
                            {{ form_start(followForm) }}
                                {{ form_row(followForm.follow) }}
                                <button type="submit" class="btn">Submit</button>
                            {{ form_end(followForm) }}
                        </td>
                    {% else %}
                        <td>
                            <p>Already followed</p> <!-- We can add here the possibilty to unfollow (this possibility is already in the webpage /myseries -->
                        </td>
                    {% endif %}
                {% endif %}
            </tr>
            <tr>
                <th>Plot</th>
                <td>{{ series.plot }}</td>
            </tr>
            <tr>
                <th>Seasons/Episodes</th>
                <td><ul>
                    {% for season in seasons %}
                        <li>Season {{ season.number }}</li> <!-- For each season, ... -->
                        <ul> 
                        {% for episode in episodes[season.number - 1] %}
                            <li> Episode {{ episode.number }} : {{ episode.title }} <!-- ... we print episodes about his season -->
                        {% endfor %}
                        </ul>
                    {% endfor %}
                </ul></td>
            </tr>
            <tr>
                <th>Imdb</th>
                <td><a href="https://www.imdb.com/title/{{ series.imdb }}">Imdb link</a></td>
            </tr>
            <tr>
                <th>Poster</th>
                <td><img src='data:image/jpeg;base64,{{ poster }}'/></td>
            </tr>
            <tr>
                <th>Director</th>
                <td>{{ series.director }}</td>
            </tr>
            <tr>
                <th>YoutubeTrailer</th>
                <td><a href="{{ series.youtubeTrailer }}">Youtube link</a></td>
            </tr>
            <tr>
                <th>Awards</th>
                <td>{{ series.awards }}</td>
            </tr>
            <tr>
                <th>YearStart</th>
                <td>{{ series.yearStart }}</td>
            </tr>
            <tr>
                <th>YearEnd</th>
                <td>{{ series.yearEnd }}</td>
            </tr>
        </tbody>
    </table>

    <a href="{{ path('series_index') }}">back to list</a>

    <a href="{{ path('series_edit', {'id': series.id}) }}">edit</a>

    {{ include('series/_delete_form.html.twig') }}
{% endblock %}
